{"ast":null,"code":"import _asyncToGenerator from \"E:/Important/FIT/project-front-end/FrontEnd_ThayLong_Nhom-21/app-chat/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { renderMethodNotFoundError, renderMissingResponseError, renderUnexpectedResultError } from './error-renderers';\nexport const createMessageHandler = (receiver, workerImplementation) => {\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator(function* ({\n      data: {\n        id,\n        method,\n        params\n      }\n    }) {\n      const messageHandler = workerImplementation[method];\n\n      try {\n        if (messageHandler === undefined) {\n          throw renderMethodNotFoundError({\n            method\n          });\n        }\n\n        const response = params === undefined ? messageHandler() : messageHandler(params);\n\n        if (response === undefined) {\n          throw renderMissingResponseError({\n            method\n          });\n        }\n\n        const synchronousResponse = response instanceof Promise ? yield response : response;\n\n        if (id === null) {\n          if (synchronousResponse.result !== undefined) {\n            throw renderUnexpectedResultError({\n              method\n            });\n          }\n        } else {\n          if (synchronousResponse.result === undefined) {\n            throw renderUnexpectedResultError({\n              method\n            });\n          }\n\n          const {\n            result,\n            transferables = []\n          } = synchronousResponse;\n          receiver.postMessage({\n            id,\n            result\n          }, transferables);\n        }\n      } catch (err) {\n        const {\n          message,\n          status = -32603\n        } = err;\n        receiver.postMessage({\n          error: {\n            code: status,\n            message\n          },\n          id\n        });\n      }\n    });\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n}; //# sourceMappingURL=create-message-handler.js.map","map":{"version":3,"sources":["E:/Important/FIT/project-front-end/FrontEnd_ThayLong_Nhom-21/app-chat/node_modules/worker-factory/build/es2019/helpers/create-message-handler.js"],"names":["renderMethodNotFoundError","renderMissingResponseError","renderUnexpectedResultError","createMessageHandler","receiver","workerImplementation","data","id","method","params","messageHandler","undefined","response","synchronousResponse","Promise","result","transferables","postMessage","err","message","status","error","code"],"mappings":";AAAA,SAASA,yBAAT,EAAoCC,0BAApC,EAAgEC,2BAAhE,QAAmG,mBAAnG;AACA,OAAO,MAAMC,oBAAoB,GAAG,CAACC,QAAD,EAAWC,oBAAX,KAAoC;AACpE;AAAA,iCAAO,WAAO;AAAEC,MAAAA,IAAI,EAAE;AAAEC,QAAAA,EAAF;AAAMC,QAAAA,MAAN;AAAcC,QAAAA;AAAd;AAAR,KAAP,EAA4C;AAC/C,YAAMC,cAAc,GAAGL,oBAAoB,CAACG,MAAD,CAA3C;;AACA,UAAI;AACA,YAAIE,cAAc,KAAKC,SAAvB,EAAkC;AAC9B,gBAAMX,yBAAyB,CAAC;AAAEQ,YAAAA;AAAF,WAAD,CAA/B;AACH;;AACD,cAAMI,QAAQ,GAAGH,MAAM,KAAKE,SAAX,GACXD,cAAc,EADH,GAEXA,cAAc,CAACD,MAAD,CAFpB;;AAGA,YAAIG,QAAQ,KAAKD,SAAjB,EAA4B;AACxB,gBAAMV,0BAA0B,CAAC;AAAEO,YAAAA;AAAF,WAAD,CAAhC;AACH;;AACD,cAAMK,mBAAmB,GAAGD,QAAQ,YAAYE,OAApB,SAAoCF,QAApC,GAA+CA,QAA3E;;AACA,YAAIL,EAAE,KAAK,IAAX,EAAiB;AACb,cAAIM,mBAAmB,CAACE,MAApB,KAA+BJ,SAAnC,EAA8C;AAC1C,kBAAMT,2BAA2B,CAAC;AAAEM,cAAAA;AAAF,aAAD,CAAjC;AACH;AACJ,SAJD,MAKK;AACD,cAAIK,mBAAmB,CAACE,MAApB,KAA+BJ,SAAnC,EAA8C;AAC1C,kBAAMT,2BAA2B,CAAC;AAAEM,cAAAA;AAAF,aAAD,CAAjC;AACH;;AACD,gBAAM;AAAEO,YAAAA,MAAF;AAAUC,YAAAA,aAAa,GAAG;AAA1B,cAAiCH,mBAAvC;AACAT,UAAAA,QAAQ,CAACa,WAAT,CAAqB;AAAEV,YAAAA,EAAF;AAAMQ,YAAAA;AAAN,WAArB,EAAqCC,aAArC;AACH;AACJ,OAvBD,CAwBA,OAAOE,GAAP,EAAY;AACR,cAAM;AAAEC,UAAAA,OAAF;AAAWC,UAAAA,MAAM,GAAG,CAAC;AAArB,YAA+BF,GAArC;AACAd,QAAAA,QAAQ,CAACa,WAAT,CAAqB;AAAEI,UAAAA,KAAK,EAAE;AAAEC,YAAAA,IAAI,EAAEF,MAAR;AAAgBD,YAAAA;AAAhB,WAAT;AAAoCZ,UAAAA;AAApC,SAArB;AACH;AACJ,KA9BD;;AAAA;AAAA;AAAA;AAAA;AA+BH,CAhCM,C,CAiCP","sourcesContent":["import { renderMethodNotFoundError, renderMissingResponseError, renderUnexpectedResultError } from './error-renderers';\r\nexport const createMessageHandler = (receiver, workerImplementation) => {\r\n    return async ({ data: { id, method, params } }) => {\r\n        const messageHandler = workerImplementation[method];\r\n        try {\r\n            if (messageHandler === undefined) {\r\n                throw renderMethodNotFoundError({ method });\r\n            }\r\n            const response = params === undefined\r\n                ? messageHandler()\r\n                : messageHandler(params);\r\n            if (response === undefined) {\r\n                throw renderMissingResponseError({ method });\r\n            }\r\n            const synchronousResponse = response instanceof Promise ? await response : response;\r\n            if (id === null) {\r\n                if (synchronousResponse.result !== undefined) {\r\n                    throw renderUnexpectedResultError({ method });\r\n                }\r\n            }\r\n            else {\r\n                if (synchronousResponse.result === undefined) {\r\n                    throw renderUnexpectedResultError({ method });\r\n                }\r\n                const { result, transferables = [] } = synchronousResponse;\r\n                receiver.postMessage({ id, result }, transferables);\r\n            }\r\n        }\r\n        catch (err) {\r\n            const { message, status = -32603 } = err;\r\n            receiver.postMessage({ error: { code: status, message }, id });\r\n        }\r\n    };\r\n};\r\n//# sourceMappingURL=create-message-handler.js.map"]},"metadata":{},"sourceType":"module"}