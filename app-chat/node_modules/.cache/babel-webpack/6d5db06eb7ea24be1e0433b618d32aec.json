{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Administrator/Desktop/FrontEnd_ThayLong_Nhom-21/app-chat/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { ChatPageCuocTroChuyenWS } from 'src/app/models/ws/chat-page/chat-page-friends-page/chat_page_cuoc_tro_chuyen_ws';\nimport { ChatPageFriendsObjectLeftWS } from 'src/app/models/ws/chat-page/chat-page-friends-page/chat_page_friends_object_left_ws';\nimport { ChatPageObjectTinNhanFriendWS } from 'src/app/models/ws/chat-page/chat-page-friends-page/chat_page_object_tin_nhan_friend_ws';\nimport { ChatPageTinhTrangXemWS } from 'src/app/models/ws/chat-page/chat-page-friends-page/chat_page_tinh_trang_xem_ws';\nimport { ChatPageTinNhanWS } from 'src/app/models/ws/chat-page/chat-page-friends-page/chat_page_tin_nhan_ws';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/fire/database\";\nimport * as i2 from \"../chat-page-process-service-ws.service\";\nimport * as i3 from \"./left-scroll-ws.service\";\nimport * as i4 from \"./chat-page-friends-websocket.service\";\nexport class ChatPageFriendsLeftServiceWsService {\n  constructor(db, main_page_process_service, // scroll\n  left_srcoll_service, chat_page_friends_websocket) {\n    this.db = db;\n    this.main_page_process_service = main_page_process_service;\n    this.left_srcoll_service = left_srcoll_service;\n    this.chat_page_friends_websocket = chat_page_friends_websocket; // index\n\n    this.indexNotSearch = -1;\n    this.search = \"\"; // Hàm update lại ban_bes 5s 1 lần\n\n    this.update();\n  }\n\n  getLanCuoiDangNhap() {\n    return this.db.object(\"/lan_cuoi_dang_nhap_ws\").snapshotChanges();\n  }\n\n  changeSearch(event) {\n    // Cập nhật lại length hiện đang được show ra\n    let count = 0;\n\n    if (this.allBoxData != null) {\n      for (let i = 0; i < this.allBoxData.length; i++) {\n        if (this.compareSearch(i)) {\n          count++;\n        }\n      }\n    }\n\n    this.nowLengthShow = count; // Cập nhật lại bộ 3 kia\n\n    this.updateBo3Index();\n  }\n\n  updateBo3Index() {\n    this.getIndexSeleced();\n    this.getIndexPre();\n    this.getIndexNext();\n  }\n\n  dienLanCuoiDangNhap(object) {\n    if (this.allBoxData != null) {\n      Object.entries(object).forEach(([key2, value2]) => {\n        for (let i = 0; i < this.allBoxData.length; i++) {\n          for (let j = 0; j < this.allBoxData[i].thong_tin_thanh_vien.length; j++) {\n            if (this.allBoxData[i].thong_tin_thanh_vien[j].ma_tai_khoan == key2) {\n              this.allBoxData[i].thong_tin_thanh_vien[j].lan_cuoi_dang_nhap = value2['lan_cuoi_dang_nhap'];\n            }\n          }\n        }\n      });\n\n      for (let i = 0; i < this.allBoxData.length; i++) {\n        for (let j = 0; j < this.allBoxData[i].thong_tin_thanh_vien.length; j++) {\n          if (this.allBoxData[i].thong_tin_thanh_vien[j].lan_cuoi_dang_nhap == null) {\n            this.allBoxData[i].thong_tin_thanh_vien[j].lan_cuoi_dang_nhap = 0;\n          }\n        }\n      }\n    }\n  }\n\n  compareSearch(i) {\n    if (this.allBoxData != null && this.allBoxData.length > 0) {\n      if (this.allBoxData[i] != null) {\n        if (this.allBoxData[i].name != null) {\n          if (this.allBoxData[i].name.noi_dung_goc != null) {\n            if (this.allBoxData[i].name.noi_dung_goc.trim().toLowerCase().includes(this.search.trim().toLowerCase())) {\n              return true;\n            }\n          }\n        }\n      }\n    }\n\n    return false;\n  }\n\n  update() {\n    let ma_tai_khoan = JSON.parse(localStorage.getItem(\"ma_tai_khoan_dn_ws\"));\n    let loop = 6000; // set biến lặp cho phù hợp để tránh trùng nhau, khoảng cách giữa 2 lần lặp = 6s\n\n    if (this.allBoxData != null && this.allBoxData.length > 0) {\n      for (let index = 0; index < this.allBoxData.length; index++) loop += index * 2000;\n\n      loop += 6000;\n    }\n\n    setTimeout(() => {\n      // Kiểm tra online\n      if (this.allBoxData != null) {\n        for (let i = 0; i < this.allBoxData.length; i++) {\n          let isOnline = false;\n\n          for (let j = 0; j < this.allBoxData[i].thong_tin_thanh_vien.length; j++) {\n            setTimeout(() => {\n              if (this.allBoxData[i].thong_tin_thanh_vien[j].ma_tai_khoan != ma_tai_khoan) {\n                this.db.database.ref('cai_dat_ws').child(this.allBoxData[i].thong_tin_thanh_vien[j].ma_tai_khoan).on('value', set => {\n                  console.log(set.val().trang_thai_hoat_dong);\n\n                  if (set.val().trang_thai_hoat_dong == 'bat') {\n                    if (this.allBoxData[i].cuoc_tro_truyen.loai_cuoc_tro_truyen == 'nhom') {\n                      if (this.allBoxData[i].thong_tin_thanh_vien[j].roi_chua == 'chua') {\n                        this.chat_page_friends_websocket.checkOnlineFriendsChat(this.allBoxData[i].thong_tin_thanh_vien[j].email);\n                        this.chat_page_friends_websocket.messages_online_friends_chat.subscribe( /*#__PURE__*/function () {\n                          var _ref = _asyncToGenerator(function* (data) {\n                            let value = yield JSON.parse(JSON.stringify(data));\n                            if (value.status == \"success\" && value.data.status) isOnline = value.data.status;\n                          });\n\n                          return function (_x) {\n                            return _ref.apply(this, arguments);\n                          };\n                        }());\n                      }\n                    } else {\n                      this.chat_page_friends_websocket.checkOnlineFriendsChat(this.allBoxData[i].thong_tin_thanh_vien[j].email);\n                      this.chat_page_friends_websocket.messages_online_friends_chat.subscribe( /*#__PURE__*/function () {\n                        var _ref2 = _asyncToGenerator(function* (data) {\n                          let value = yield JSON.parse(JSON.stringify(data));\n                          if (value.status == \"success\" && value.data.status) isOnline = value.data.status;\n                        });\n\n                        return function (_x2) {\n                          return _ref2.apply(this, arguments);\n                        };\n                      }());\n                    }\n                  }\n                });\n              }\n            }, j * 2000);\n            if (isOnline) break;\n          }\n\n          this.allBoxData[i].trang_thai_online = isOnline;\n        }\n      }\n\n      this.update();\n    }, loop);\n  } // Get index đang được chọn\n\n\n  getIndexSeleced() {\n    let index = -1;\n\n    if (this.allBoxData != null) {\n      let select = -1;\n\n      for (let i = 0; i < this.allBoxData.length; i++) {\n        if (this.allBoxData[i].box_chat_dang_duoc_chon) {\n          select = i;\n          break;\n        }\n      }\n\n      if (!this.compareSearch(select)) {\n        index = -1;\n      } else {\n        let count = 0;\n\n        for (let i = 0; i <= select; i++) {\n          if (!this.compareSearch(i)) {\n            count++;\n          }\n        }\n\n        index = select - count;\n      }\n    }\n\n    this.indexSelect = index;\n  }\n\n  getIndexPre() {\n    let index = -1;\n\n    if (this.allBoxData != null) {\n      let select = -1;\n\n      for (let i = 0; i < this.allBoxData.length; i++) {\n        if (this.allBoxData[i].box_chat_dang_duoc_chon) {\n          select = i;\n          break;\n        }\n      }\n\n      let count = -1;\n\n      for (let i = select - 1; i > -1; i--) {\n        if (this.compareSearch(i)) {\n          count = i;\n          break;\n        }\n      }\n\n      index = count;\n    }\n\n    this.indexPre = index;\n  }\n\n  getIndexNext() {\n    let index = -1;\n\n    if (this.allBoxData != null) {\n      let select = -1;\n\n      for (let i = 0; i < this.allBoxData.length; i++) {\n        if (this.allBoxData[i].box_chat_dang_duoc_chon) {\n          select = i;\n          break;\n        }\n      }\n\n      let count = -1;\n\n      for (let i = select + 1; i < this.allBoxData.length; i++) {\n        if (this.compareSearch(i)) {\n          count = i;\n          break;\n        }\n      }\n\n      index = count;\n    }\n\n    this.indexNext = index;\n  }\n\n  updateSelected() {\n    // Select\n    let isOke = false;\n\n    for (let i = 0; i < this.allBoxData.length; i++) {\n      if (this.allBoxData[i].cuoc_tro_truyen.ma_cuoc_tro_chuyen == this.now_ma_cuoc_tro_chuyen) {\n        this.allBoxData[i].box_chat_dang_duoc_chon = true; // Cập nhật index not search\n\n        this.indexNotSearch = i;\n        isOke = true;\n      } else {\n        this.allBoxData[i].box_chat_dang_duoc_chon = false;\n      }\n    }\n\n    if (!isOke) {\n      this.indexNotSearch = -1;\n    } // update to left srcoll\n\n\n    this.left_srcoll_service.indexNotSearch = this.indexNotSearch;\n    this.updateScroll(); // update bộ 3 index\n\n    this.updateBo3Index();\n  }\n\n  updateScroll() {\n    let danh_sach_ban_ben_duoi = document.getElementById(\"danh_sach_ban_be_ben_duoi\");\n\n    if (danh_sach_ban_ben_duoi != null) {\n      if (this.indexNotSearch != -1) {\n        if (this.indexNotSearch < 3) {\n          danh_sach_ban_ben_duoi.scrollTo({\n            top: 0,\n            behavior: \"smooth\"\n          });\n        } else {\n          danh_sach_ban_ben_duoi.scrollTo({\n            top: (this.indexNotSearch - 2) * 76,\n            behavior: \"smooth\"\n          });\n        }\n      }\n    }\n  }\n\n  seen(ma_cuoc_tro_chuyen) {\n    for (let i = 0; i < this.allBoxData.length; i++) {\n      if (this.allBoxData[i].cuoc_tro_truyen.ma_cuoc_tro_chuyen == ma_cuoc_tro_chuyen) {\n        if (this.allBoxData[i].cuoc_tro_truyen.tin_nhan != null) {\n          let ma_tai_khoan = JSON.parse(localStorage.getItem(\"ma_tai_khoan_dn_ws\"));\n          let currentTime = Number(new Date());\n\n          for (let j = 0; j < this.allBoxData[i].cuoc_tro_truyen.tin_nhan.length; j++) {\n            if (this.isChuaXem(this.allBoxData[i].cuoc_tro_truyen.tin_nhan[j].tinh_trang_xem)) {\n              let url = \"/chi_tiet_cuoc_tro_chuyen_ws/\" + this.allBoxData[i].cuoc_tro_truyen.ma_cuoc_tro_chuyen + \"/\" + this.allBoxData[i].cuoc_tro_truyen.tin_nhan[j].ma_tin_nhan + \"/tinh_trang_xem/\" + ma_tai_khoan;\n              this.db.database.ref(url).update({\n                xem_chua: \"roi\",\n                ngay_xem: currentTime\n              });\n            }\n          }\n\n          break;\n        }\n      }\n    }\n  }\n\n  da_nhan() {\n    let ma_tai_khoan = JSON.parse(localStorage.getItem(\"ma_tai_khoan_dn_ws\"));\n\n    for (let i = 0; i < this.allBoxData.length; i++) {\n      if (this.allBoxData[i].cuoc_tro_truyen.tin_nhan != null) {\n        let currentTime = Number(new Date());\n\n        for (let j = 0; j < this.allBoxData[i].cuoc_tro_truyen.tin_nhan.length; j++) {\n          if (this.isNhanChua(this.allBoxData[i].cuoc_tro_truyen.tin_nhan[j].tinh_trang_xem)) {\n            let url = \"/chi_tiet_cuoc_tro_chuyen_ws/\" + this.allBoxData[i].cuoc_tro_truyen.ma_cuoc_tro_chuyen + \"/\" + this.allBoxData[i].cuoc_tro_truyen.tin_nhan[j].ma_tin_nhan + \"/tinh_trang_xem/\" + ma_tai_khoan;\n            this.db.database.ref(url).update({\n              xem_chua: \"dang\",\n              ngay_nhan: currentTime\n            });\n          }\n        }\n      }\n    }\n  }\n\n  isChuaXem(array) {\n    let ma_tai_khoan = JSON.parse(localStorage.getItem(\"ma_tai_khoan_dn_ws\"));\n\n    for (let i = 0; i < array.length; i++) {\n      if (array[i].ma_tai_khoan == ma_tai_khoan) {\n        if (array[i].xem_chua == \"roi\") {\n          return false;\n        } else {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  isNhanChua(array) {\n    let ma_tai_khoan = JSON.parse(localStorage.getItem(\"ma_tai_khoan_dn_ws\"));\n\n    for (let i = 0; i < array.length; i++) {\n      if (array[i].ma_tai_khoan == ma_tai_khoan) {\n        if (array[i].xem_chua == \"roi\" || array[i].xem_chua == \"dang\") {\n          return false;\n        } else {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  checkUrl(ma_cuoc_tro_chuyen) {\n    for (let i = 0; i < this.allBoxData.length; i++) {\n      if (this.allBoxData[i].cuoc_tro_truyen.ma_cuoc_tro_chuyen == ma_cuoc_tro_chuyen) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  dienAllTinNhan(object) {\n    if (object != null) {\n      Object.entries(object).forEach(([key, value]) => {\n        this.dienTinNhan(key, value);\n      });\n    } // ông nào ko có tin nhắn -> những cuộc trò chuyện đơn\n    // Ta sẽ getIsReaded\n\n\n    for (let i = 0; i < this.allBoxData.length; i++) {\n      if (this.allBoxData[i].cuoc_tro_truyen.tin_nhan == null) {\n        this.allBoxData[i].getIsReaded();\n      }\n    }\n  }\n\n  dienTinNhan(key, value) {\n    for (let i = 0; i < this.allBoxData.length; i++) {\n      if (this.allBoxData[i].cuoc_tro_truyen.ma_cuoc_tro_chuyen == key) {\n        let tin_nhans = [];\n        Object.entries(value).forEach(([ma_tin_nhan, data_tin_nhan]) => {\n          let tin_nhan = new ChatPageTinNhanWS();\n          tin_nhan.ma_tin_nhan = ma_tin_nhan;\n          tin_nhan.dia_chi_file = data_tin_nhan['dia_chi_file'];\n          tin_nhan.link_file = data_tin_nhan['link_file'];\n          tin_nhan.loai_tin_nhan = data_tin_nhan['loai_tin_nhan'];\n          tin_nhan.ma_tai_khoan = data_tin_nhan['ma_tai_khoan'];\n          tin_nhan.ten = data_tin_nhan['ten'];\n          tin_nhan.ma_tin_nhan_phan_hoi = data_tin_nhan['ma_tin_nhan_phan_hoi'];\n          tin_nhan.ngay_gui = data_tin_nhan['ngay_gui'];\n          tin_nhan.noi_dung = data_tin_nhan['noi_dung'];\n          tin_nhan.alt = data_tin_nhan['alt'];\n          let tinhTrangXem = data_tin_nhan['tinh_trang_xem'];\n          let tinh_trang_xems = [];\n\n          if (tinhTrangXem != null) {\n            Object.entries(tinhTrangXem).forEach(([ma_tai_khoan, data]) => {\n              let o = new ChatPageTinhTrangXemWS();\n              o.ma_tai_khoan = ma_tai_khoan;\n              o.ngay_xem = data['ngay_xem'];\n              o.xem_chua = data['xem_chua'];\n              o.ngay_nhan = data['ngay_nhan'];\n              o.is_roi_chua = this.taiKhoanTinhTrangXemRoiChua(o.ma_tai_khoan, i);\n              tinh_trang_xems.push(o);\n            });\n            tin_nhan.tinh_trang_xem = tinh_trang_xems;\n            tin_nhans.push(tin_nhan);\n          }\n        });\n        this.allBoxData[i].cuoc_tro_truyen.tin_nhan = tin_nhans; // Điền tin nhắn cho boxData[i] thì lấy luôn nội dung của nó để đổ ra view cho đỡ lag\n        // Lấy vị trí bản thân\n\n        this.allBoxData[i].getViTriBanThan(); // Lấy vị trí tin nhắn cuối cùng\n\n        this.allBoxData[i].getIndexTinNhanCuoiCung(); // Lấy nội dung tin nhắn cuối cùng\n\n        this.allBoxData[i].getNoiDungCuoiCung(); // Tin nhắn cuối cùng được đọc chưa\n\n        this.allBoxData[i].getIsReaded(); // Kiểm tra thử vị trí cuối cùng có phải là của bản thân hay không\n\n        this.allBoxData[i].isMe(); // Kiểm tra xem ông nào nhậ nchuwa\n\n        this.allBoxData[i].getIsDaNhan(); // Kiểm tra bản thân rời khỏi cuộc trò chuyện chưa\n\n        this.allBoxData[i].getIsRoiChua();\n        return;\n      }\n    }\n  }\n\n  taiKhoanTinhTrangXemRoiChua(mtk, index) {\n    for (let i = 0; i < this.allBoxData[index].thong_tin_thanh_vien.length; i++) {\n      if (this.allBoxData[index].thong_tin_thanh_vien[i].ma_tai_khoan == mtk) {\n        if (this.allBoxData[index].thong_tin_thanh_vien[i].roi_chua == 'roi') {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  sort() {\n    // sort lại theo ngày gửi của tin nhắn cuối cùng\n    this.allBoxData = this.allBoxData.sort((boxData1, boxData2) => {\n      let last_time_boxData1 = boxData1.getLastTime();\n      let last_time_boxData2 = boxData2.getLastTime();\n      return last_time_boxData2 - last_time_boxData1;\n    });\n  }\n\n  dienTenVaHinhChoTaiKhoanTrongBoxData(key, value) {\n    if (this.allBoxData != null) {\n      for (let i = 0; i < this.allBoxData.length; i++) {\n        // Điền dữ liệu tài khoản cho thành viên\n        for (let j = 0; j < this.allBoxData[i].thong_tin_thanh_vien.length; j++) {\n          if (this.allBoxData[i].thong_tin_thanh_vien[j].ma_tai_khoan == key) {\n            this.allBoxData[i].thong_tin_thanh_vien[j].ten = value['ten'];\n            this.allBoxData[i].thong_tin_thanh_vien[j].link_hinh_dai_dien = value['link_hinh'];\n            this.allBoxData[i].thong_tin_thanh_vien[j].email = value['email']; // khi thông tin thành viên có link hình thì cập nhật lại img avatar ở cuộc trò chuyện để đổ \n            // ra view ko bị lag\n            // img \n\n            this.allBoxData[i].getImgAvatar(); // Tên - tên nhóm - hoặc người nếu là đơn\n\n            this.allBoxData[i].getName();\n            break;\n          }\n        } // Điền duẽ liệu tài khoản cho cuoc_tro_chuyen\n\n\n        if (this.allBoxData[i].cuoc_tro_truyen.ma_tai_khoan_chu_so_huu == key) {\n          this.allBoxData[i].cuoc_tro_truyen.ten_nguoi_so_huu = value['ten'];\n        } // Điền dữ liệu tài khoản cho tin nhắn\n\n\n        if (this.allBoxData[i].cuoc_tro_truyen.tin_nhan != null) {\n          for (let j = 0; j < this.allBoxData[i].cuoc_tro_truyen.tin_nhan.length; j++) {\n            // Tình trạng xem\n            for (let k = 0; k < this.allBoxData[i].cuoc_tro_truyen.tin_nhan[j].tinh_trang_xem.length; k++) {\n              if (this.allBoxData[i].cuoc_tro_truyen.tin_nhan[j].tinh_trang_xem[k].ma_tai_khoan == key) {\n                this.allBoxData[i].cuoc_tro_truyen.tin_nhan[j].tinh_trang_xem[k].ten = value['ten'];\n                this.allBoxData[i].cuoc_tro_truyen.tin_nhan[j].tinh_trang_xem[k].hinh = value['link_hinh'];\n              }\n            } // Tin nhắn\n\n\n            if (this.allBoxData[i].cuoc_tro_truyen.tin_nhan[j].ma_tai_khoan == key) {\n              this.allBoxData[i].cuoc_tro_truyen.tin_nhan[j].ten = value['ten'];\n            }\n          } // Điền hết tình trạgn xem của tin nhắn thì get imgseened\n\n\n          this.allBoxData[i].getImgUserSeened();\n        }\n      }\n    }\n  }\n\n  getBoxData(key, value) {\n    let ma_tai_khoan = JSON.parse(localStorage.getItem(\"ma_tai_khoan_dn_ws\"));\n    let boxData = new ChatPageFriendsObjectLeftWS();\n\n    for (let i = 0; i < this.allCuocTroTruyen.length; i++) {\n      if (this.allCuocTroTruyen[i].ma_cuoc_tro_chuyen == key) {\n        // clone chat page cuoc tro chuyen\n        let chatPageCuocTroChuyen = new ChatPageCuocTroChuyenWS();\n        chatPageCuocTroChuyen.ma_cuoc_tro_chuyen = this.allCuocTroTruyen[i].ma_cuoc_tro_chuyen;\n        chatPageCuocTroChuyen.loai_cuoc_tro_truyen = this.allCuocTroTruyen[i].loai_cuoc_tro_truyen;\n        chatPageCuocTroChuyen.ngay_tao = this.allCuocTroTruyen[i].ngay_tao;\n        chatPageCuocTroChuyen.ten_nhom = this.allCuocTroTruyen[i].ten_nhom;\n        chatPageCuocTroChuyen.ton_tai = this.allCuocTroTruyen[i].ton_tai;\n        chatPageCuocTroChuyen.ma_tai_khoan_chu_so_huu = this.allCuocTroTruyen[i].ma_tai_khoan_chu_so_huu;\n        chatPageCuocTroChuyen.ten_nguoi_so_huu = this.allCuocTroTruyen[i].ten_nguoi_so_huu;\n        boxData.cuoc_tro_truyen = chatPageCuocTroChuyen; // Điền các thông tin đầu tiên cho các thành viên\n\n        let thong_tin_thanh_vien = []; // oke khi có bản thân và bản thân phải ko chờ\n\n        let isOke = false;\n        Object.entries(value).forEach(([key2, value2]) => {\n          let chat_page_object_tin_nhan_friend = new ChatPageObjectTinNhanFriendWS();\n          chat_page_object_tin_nhan_friend.ma_tai_khoan = key2;\n          chat_page_object_tin_nhan_friend.ngay_tham_gia = value2['ngay_tham_gia'];\n          chat_page_object_tin_nhan_friend.ngay_roi_di = value2['ngay_roi_di'];\n          chat_page_object_tin_nhan_friend.roi_chua = value2['roi_chua'];\n          thong_tin_thanh_vien.push(chat_page_object_tin_nhan_friend);\n\n          if (!isOke) {\n            if (key2 == ma_tai_khoan) {\n              if (value2['trang_thai'] == 'khong_cho') {\n                isOke = true;\n              }\n            }\n          }\n        });\n        if (!isOke) return null;\n        boxData.thong_tin_thanh_vien = thong_tin_thanh_vien;\n        boxData.box_chat_dang_duoc_chon = false;\n        break;\n      }\n    }\n\n    return boxData;\n  }\n\n  getAllTaiKhoan() {\n    return this.db.object(\"/tai_khoan_ws\").snapshotChanges();\n  }\n\n  getAllChiTietCuocTroChuyen() {\n    return this.db.object(\"/chi_tiet_cuoc_tro_chuyen_ws\").snapshotChanges();\n  }\n\n  getAllCuocTroChuyen() {\n    return this.db.object(\"/cuoc_tro_chuyen_ws\").snapshotChanges();\n  }\n\n  getAllCuocTroChuyenNhom() {\n    return this.db.object(\"/thong_tin_tro_chuyen_nhom_ws\").snapshotChanges();\n  }\n\n  dienThongTinNhom(ma_nhom, value) {\n    for (let i = 0; i < this.allCuocTroTruyen.length; i++) {\n      if (this.allCuocTroTruyen[i].loai_cuoc_tro_truyen == 'nhom') {\n        if (this.allCuocTroTruyen[i].ma_cuoc_tro_chuyen == ma_nhom && value['ton_tai'] == 0) {\n          this.allCuocTroTruyen[i].ten_nhom = value['ten_nhom'];\n          this.allCuocTroTruyen[i].ngay_tao = value['ngay_tao'];\n          this.allCuocTroTruyen[i].ma_tai_khoan_chu_so_huu = value['chu_so_huu'];\n          this.allCuocTroTruyen[i].ton_tai = value['ton_tai'];\n          break;\n        }\n      }\n    }\n  }\n\n  getThanhVienCuocTroTruyen() {\n    return this.db.object(\"/thanh_vien_cuoc_tro_chuyen_ws\").snapshotChanges();\n  }\n\n}\n\nChatPageFriendsLeftServiceWsService.ɵfac = function ChatPageFriendsLeftServiceWsService_Factory(t) {\n  return new (t || ChatPageFriendsLeftServiceWsService)(i0.ɵɵinject(i1.AngularFireDatabase), i0.ɵɵinject(i2.ChatPageProcessServiceWsService), i0.ɵɵinject(i3.LeftScrollWsService), i0.ɵɵinject(i4.ChatPageFriendsWebsocketService));\n};\n\nChatPageFriendsLeftServiceWsService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: ChatPageFriendsLeftServiceWsService,\n  factory: ChatPageFriendsLeftServiceWsService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"sources":["C:\\Users\\Administrator\\Desktop\\FrontEnd_ThayLong_Nhom-21\\app-chat\\src\\app\\service\\ws\\chat-page\\chat-page-friends-page\\chat-page-friends-left-service-ws.service.ts"],"names":[],"mappings":"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","sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { AngularFireDatabase } from '@angular/fire/database';\r\nimport { Subscription } from 'rxjs';\r\nimport { ChatPageCuocTroChuyenWS } from 'src/app/models/ws/chat-page/chat-page-friends-page/chat_page_cuoc_tro_chuyen_ws';\r\nimport { ChatPageFriendsObjectLeftWS } from 'src/app/models/ws/chat-page/chat-page-friends-page/chat_page_friends_object_left_ws';\r\nimport { ChatPageObjectTinNhanFriendWS } from 'src/app/models/ws/chat-page/chat-page-friends-page/chat_page_object_tin_nhan_friend_ws';\r\nimport { ChatPageTinhTrangXemWS } from 'src/app/models/ws/chat-page/chat-page-friends-page/chat_page_tinh_trang_xem_ws';\r\nimport { ChatPageTinNhanWS } from 'src/app/models/ws/chat-page/chat-page-friends-page/chat_page_tin_nhan_ws';\r\nimport { ChatPageProcessServiceWsService } from '../chat-page-process-service-ws.service';\r\nimport { ChatPageFriendsWebsocketService } from './chat-page-friends-websocket.service';\r\nimport { LeftScrollWsService } from './left-scroll-ws.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ChatPageFriendsLeftServiceWsService {\r\n  // ma_cuoc_tro_chuyen hien hien tai\r\n  public now_ma_cuoc_tro_chuyen: string;\r\n\r\n  // Danh sách all cuộc trò truyện\r\n  public allCuocTroTruyen: ChatPageCuocTroChuyenWS[];\r\n  // Danh sách các box chat để hiển thị ra\r\n  public allBoxData: ChatPageFriendsObjectLeftWS[];\r\n  public search: string;\r\n\r\n  // Service\r\n  public layAllCuocTroChuyen: Subscription;\r\n  public layAllCuocTroChuyenNhom: Subscription;\r\n  public layThanhVienCuocTroChuyenLeft: Subscription;\r\n  public layAllChiTietCuocTroChuyen: Subscription;\r\n  public layThongTinThanhVien: Subscription;\r\n  public layLanCuoiDangNhap: Subscription;\r\n\r\n  // index\r\n  public indexNotSearch: number = -1;\r\n\r\n  // Length hiện đang được đổ ra\r\n  public nowLengthShow: number;\r\n\r\n  // Bộ 3 index next pre select\r\n  public indexNext: number;\r\n  public indexPre: number;\r\n  public indexSelect: number;\r\n  public isLoadFirst: boolean;\r\n\r\n  constructor(\r\n    private db: AngularFireDatabase,\r\n    private main_page_process_service: ChatPageProcessServiceWsService,\r\n    // scroll\r\n    private left_srcoll_service: LeftScrollWsService,\r\n    private chat_page_friends_websocket: ChatPageFriendsWebsocketService\r\n  ) {\r\n    this.search = \"\";\r\n    // Hàm update lại ban_bes 5s 1 lần\r\n    this.update();\r\n  }\r\n\r\n  public getLanCuoiDangNhap() {\r\n    return this.db.object(\"/lan_cuoi_dang_nhap_ws\").snapshotChanges();\r\n  }\r\n\r\n  public changeSearch(event) {\r\n    // Cập nhật lại length hiện đang được show ra\r\n    let count = 0;\r\n    if (this.allBoxData != null) {\r\n      for (let i = 0; i < this.allBoxData.length; i++) {\r\n        if (this.compareSearch(i)) {\r\n          count++;\r\n        }\r\n      }\r\n    }\r\n    this.nowLengthShow = count;\r\n    // Cập nhật lại bộ 3 kia\r\n    this.updateBo3Index();\r\n  }\r\n\r\n  public updateBo3Index() {\r\n    this.getIndexSeleced();\r\n    this.getIndexPre();\r\n    this.getIndexNext();\r\n  }\r\n\r\n  public dienLanCuoiDangNhap(object: Object) {\r\n    if (this.allBoxData != null) {\r\n      Object.entries(object).forEach(([key2, value2]) => {\r\n        for (let i = 0; i < this.allBoxData.length; i++) {\r\n          for (let j = 0; j < this.allBoxData[i].thong_tin_thanh_vien.length; j++) {\r\n            if (this.allBoxData[i].thong_tin_thanh_vien[j].ma_tai_khoan == key2) {\r\n              this.allBoxData[i].thong_tin_thanh_vien[j].lan_cuoi_dang_nhap = value2['lan_cuoi_dang_nhap'];\r\n            }\r\n          }\r\n        }\r\n      });\r\n      for (let i = 0; i < this.allBoxData.length; i++) {\r\n        for (let j = 0; j < this.allBoxData[i].thong_tin_thanh_vien.length; j++) {\r\n          if (this.allBoxData[i].thong_tin_thanh_vien[j].lan_cuoi_dang_nhap == null) {\r\n            this.allBoxData[i].thong_tin_thanh_vien[j].lan_cuoi_dang_nhap = 0;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  public compareSearch(i: number): boolean {\r\n    if (this.allBoxData != null && this.allBoxData.length > 0) {\r\n      if (this.allBoxData[i] != null) {\r\n        if (this.allBoxData[i].name != null) {\r\n          if (this.allBoxData[i].name.noi_dung_goc != null) {\r\n            if (this.allBoxData[i].name.noi_dung_goc.trim().toLowerCase().includes(this.search.trim().toLowerCase())) {\r\n              return true;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  public update(): void {\r\n    let ma_tai_khoan = JSON.parse(localStorage.getItem(\"ma_tai_khoan_dn_ws\"));\r\n    let loop = 6000;\r\n    // set biến lặp cho phù hợp để tránh trùng nhau, khoảng cách giữa 2 lần lặp = 6s\r\n    if(this.allBoxData != null && this.allBoxData.length > 0) {\r\n      for (let index = 0; index < this.allBoxData.length; index++)\r\n          loop += index * 2000;\r\n      loop += 6000;\r\n    }\r\n    setTimeout(() => {\r\n      // Kiểm tra online\r\n\r\n      if (this.allBoxData != null) {\r\n        for (let i = 0; i < this.allBoxData.length; i++) {\r\n          let isOnline = false;\r\n          for (let j = 0; j < this.allBoxData[i].thong_tin_thanh_vien.length; j++) {\r\n            setTimeout(() => {\r\n           \r\n              if (this.allBoxData[i].thong_tin_thanh_vien[j].ma_tai_khoan != ma_tai_khoan) {\r\n                this.db.database.ref('cai_dat_ws').child(this.allBoxData[i].thong_tin_thanh_vien[j].ma_tai_khoan).on('value', set => {\r\n                  console.log(set.val().trang_thai_hoat_dong)\r\n                  if(set.val().trang_thai_hoat_dong == 'bat') {\r\n                    if (this.allBoxData[i].cuoc_tro_truyen.loai_cuoc_tro_truyen == 'nhom') {\r\n                      if (this.allBoxData[i].thong_tin_thanh_vien[j].roi_chua == 'chua') {\r\n                        \r\n                        this.chat_page_friends_websocket.checkOnlineFriendsChat(this.allBoxData[i].thong_tin_thanh_vien[j].email);\r\n                        this.chat_page_friends_websocket.messages_online_friends_chat.subscribe(async (data) => {\r\n                          let value = await JSON.parse(JSON.stringify(data));\r\n                          if (value.status == \"success\" && value.data.status)\r\n                                isOnline = value.data.status;\r\n                            \r\n                        });\r\n                      \r\n                      }\r\n                    } else {\r\n                      this.chat_page_friends_websocket.checkOnlineFriendsChat(this.allBoxData[i].thong_tin_thanh_vien[j].email);\r\n                      this.chat_page_friends_websocket.messages_online_friends_chat.subscribe(async (data) => {\r\n                        let value = await JSON.parse(JSON.stringify(data));\r\n                        if (value.status == \"success\" && value.data.status)\r\n                              isOnline = value.data.status;\r\n                          \r\n                      });\r\n                    }\r\n                  }\r\n                 \r\n                })\r\n              }\r\n            }, j * 2000);\r\n            if(isOnline)\r\n                break;\r\n          }\r\n          this.allBoxData[i].trang_thai_online = isOnline;\r\n         \r\n        }\r\n      }\r\n      this.update();\r\n    }, loop);\r\n  }\r\n\r\n  // Get index đang được chọn\r\n  public getIndexSeleced() {\r\n    let index = -1;\r\n    if (this.allBoxData != null) {\r\n      let select = -1;\r\n      for (let i = 0; i < this.allBoxData.length; i++) {\r\n        if (this.allBoxData[i].box_chat_dang_duoc_chon) {\r\n          select = i;\r\n          break;\r\n        }\r\n      }\r\n      if (!this.compareSearch(select)) {\r\n        index = -1;\r\n      } else {\r\n        let count = 0;\r\n        for (let i = 0; i <= select; i++) {\r\n          if (!this.compareSearch(i)) {\r\n            count++;\r\n          }\r\n        }\r\n        index = select - count;\r\n      }\r\n    }\r\n    this.indexSelect = index;\r\n  }\r\n\r\n  public getIndexPre() {\r\n    let index = -1;\r\n    if (this.allBoxData != null) {\r\n      let select = -1;\r\n      for (let i = 0; i < this.allBoxData.length; i++) {\r\n        if (this.allBoxData[i].box_chat_dang_duoc_chon) {\r\n          select = i;\r\n          break;\r\n        }\r\n      }\r\n      let count = -1;\r\n      for (let i = select - 1; i > -1; i--) {\r\n        if (this.compareSearch(i)) {\r\n          count = i;\r\n          break;\r\n        }\r\n      }\r\n      index = count;\r\n    }\r\n    this.indexPre = index;\r\n  }\r\n\r\n\r\n  public getIndexNext() {\r\n    let index = -1;\r\n    if (this.allBoxData != null) {\r\n      let select = -1;\r\n      for (let i = 0; i < this.allBoxData.length; i++) {\r\n        if (this.allBoxData[i].box_chat_dang_duoc_chon) {\r\n          select = i;\r\n          break;\r\n        }\r\n      }\r\n      let count = -1;\r\n      for (let i = select + 1; i < this.allBoxData.length; i++) {\r\n        if (this.compareSearch(i)) {\r\n          count = i;\r\n          break;\r\n        }\r\n      }\r\n      index = count;\r\n    }\r\n    this.indexNext = index;\r\n  }\r\n\r\n  public updateSelected() {\r\n    // Select\r\n    let isOke = false;\r\n    for (let i = 0; i < this.allBoxData.length; i++) {\r\n      if (this.allBoxData[i].cuoc_tro_truyen.ma_cuoc_tro_chuyen == this.now_ma_cuoc_tro_chuyen) {\r\n        this.allBoxData[i].box_chat_dang_duoc_chon = true;\r\n        // Cập nhật index not search\r\n        this.indexNotSearch = i;\r\n        isOke = true;\r\n      } else {\r\n        this.allBoxData[i].box_chat_dang_duoc_chon = false;\r\n      }\r\n    }\r\n    if (!isOke) {\r\n      this.indexNotSearch = -1;\r\n    }\r\n    // update to left srcoll\r\n    this.left_srcoll_service.indexNotSearch = this.indexNotSearch;\r\n    this.updateScroll();\r\n    // update bộ 3 index\r\n    this.updateBo3Index();\r\n  }\r\n\r\n  public updateScroll() {\r\n    let danh_sach_ban_ben_duoi = document.getElementById(\"danh_sach_ban_be_ben_duoi\");\r\n    if (danh_sach_ban_ben_duoi != null) {\r\n      if (this.indexNotSearch != -1) {\r\n        if (this.indexNotSearch < 3) {\r\n          danh_sach_ban_ben_duoi.scrollTo({ top: 0, behavior: \"smooth\" });\r\n        } else {\r\n          danh_sach_ban_ben_duoi.scrollTo({ top: (this.indexNotSearch - 2) * 76, behavior: \"smooth\" });\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  public seen(ma_cuoc_tro_chuyen: string) {\r\n    for (let i = 0; i < this.allBoxData.length; i++) {\r\n      if (this.allBoxData[i].cuoc_tro_truyen.ma_cuoc_tro_chuyen == ma_cuoc_tro_chuyen) {\r\n        if (this.allBoxData[i].cuoc_tro_truyen.tin_nhan != null) {\r\n          let ma_tai_khoan = JSON.parse(localStorage.getItem(\"ma_tai_khoan_dn_ws\"));\r\n          let currentTime = Number(new Date());\r\n          for (let j = 0; j < this.allBoxData[i].cuoc_tro_truyen.tin_nhan.length; j++) {\r\n            if (this.isChuaXem(this.allBoxData[i].cuoc_tro_truyen.tin_nhan[j].tinh_trang_xem)) {\r\n              let url = \"/chi_tiet_cuoc_tro_chuyen_ws/\" + this.allBoxData[i].cuoc_tro_truyen.ma_cuoc_tro_chuyen + \"/\" + this.allBoxData[i].cuoc_tro_truyen.tin_nhan[j].ma_tin_nhan + \"/tinh_trang_xem/\" + ma_tai_khoan;\r\n              this.db.database.ref(url).update({ xem_chua: \"roi\", ngay_xem: currentTime });\r\n            }\r\n          }\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  public da_nhan() {\r\n    let ma_tai_khoan = JSON.parse(localStorage.getItem(\"ma_tai_khoan_dn_ws\"));\r\n    for (let i = 0; i < this.allBoxData.length; i++) {\r\n      if (this.allBoxData[i].cuoc_tro_truyen.tin_nhan != null) {\r\n        let currentTime = Number(new Date());\r\n        for (let j = 0; j < this.allBoxData[i].cuoc_tro_truyen.tin_nhan.length; j++) {\r\n          if (this.isNhanChua(this.allBoxData[i].cuoc_tro_truyen.tin_nhan[j].tinh_trang_xem)) {\r\n            let url = \"/chi_tiet_cuoc_tro_chuyen_ws/\" + this.allBoxData[i].cuoc_tro_truyen.ma_cuoc_tro_chuyen + \"/\" + this.allBoxData[i].cuoc_tro_truyen.tin_nhan[j].ma_tin_nhan + \"/tinh_trang_xem/\" + ma_tai_khoan;\r\n            this.db.database.ref(url).update({ xem_chua: \"dang\", ngay_nhan: currentTime });\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  public isChuaXem(array: ChatPageTinhTrangXemWS[]): boolean {\r\n    let ma_tai_khoan = JSON.parse(localStorage.getItem(\"ma_tai_khoan_dn_ws\"));\r\n    for (let i = 0; i < array.length; i++) {\r\n      if (array[i].ma_tai_khoan == ma_tai_khoan) {\r\n        if (array[i].xem_chua == \"roi\") {\r\n          return false;\r\n        } else {\r\n          return true;\r\n        }\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  public isNhanChua(array: ChatPageTinhTrangXemWS[]): boolean {\r\n    let ma_tai_khoan = JSON.parse(localStorage.getItem(\"ma_tai_khoan_dn_ws\"));\r\n    for (let i = 0; i < array.length; i++) {\r\n      if (array[i].ma_tai_khoan == ma_tai_khoan) {\r\n        if (array[i].xem_chua == \"roi\" || array[i].xem_chua == \"dang\") {\r\n          return false;\r\n        } else {\r\n          return true;\r\n        }\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  public checkUrl(ma_cuoc_tro_chuyen: string): boolean {\r\n    for (let i = 0; i < this.allBoxData.length; i++) {\r\n      if (this.allBoxData[i].cuoc_tro_truyen.ma_cuoc_tro_chuyen == ma_cuoc_tro_chuyen) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  public dienAllTinNhan(object: Object) {\r\n    if (object != null) {\r\n      Object.entries(object).forEach(([key, value]) => {\r\n        this.dienTinNhan(key, value);\r\n      });\r\n    }\r\n    // ông nào ko có tin nhắn -> những cuộc trò chuyện đơn\r\n    // Ta sẽ getIsReaded\r\n    for (let i = 0; i < this.allBoxData.length; i++) {\r\n      if (this.allBoxData[i].cuoc_tro_truyen.tin_nhan == null) {\r\n        this.allBoxData[i].getIsReaded();\r\n      }\r\n    }\r\n  }\r\n\r\n  public dienTinNhan(key: string, value: object) {\r\n    for (let i = 0; i < this.allBoxData.length; i++) {\r\n      if (this.allBoxData[i].cuoc_tro_truyen.ma_cuoc_tro_chuyen == key) {\r\n      \r\n        let tin_nhans: ChatPageTinNhanWS[] = [];\r\n        Object.entries(value).forEach(([ma_tin_nhan, data_tin_nhan]) => {\r\n          let tin_nhan = new ChatPageTinNhanWS();\r\n          tin_nhan.ma_tin_nhan = ma_tin_nhan;\r\n          tin_nhan.dia_chi_file = data_tin_nhan['dia_chi_file'];\r\n          tin_nhan.link_file = data_tin_nhan['link_file'];\r\n          tin_nhan.loai_tin_nhan = data_tin_nhan['loai_tin_nhan'];\r\n          tin_nhan.ma_tai_khoan = data_tin_nhan['ma_tai_khoan'];\r\n          tin_nhan.ten = data_tin_nhan['ten'];\r\n          tin_nhan.ma_tin_nhan_phan_hoi = data_tin_nhan['ma_tin_nhan_phan_hoi'];\r\n          tin_nhan.ngay_gui = data_tin_nhan['ngay_gui'];\r\n          tin_nhan.noi_dung = data_tin_nhan['noi_dung'];\r\n          tin_nhan.alt = data_tin_nhan['alt'];\r\n          let tinhTrangXem: object = data_tin_nhan['tinh_trang_xem'];\r\n          let tinh_trang_xems: ChatPageTinhTrangXemWS[] = [];\r\n          if (tinhTrangXem != null) {\r\n            Object.entries(tinhTrangXem).forEach(([ma_tai_khoan, data]) => {\r\n              let o = new ChatPageTinhTrangXemWS();\r\n              o.ma_tai_khoan = ma_tai_khoan;\r\n              o.ngay_xem = data['ngay_xem'];\r\n              o.xem_chua = data['xem_chua'];\r\n              o.ngay_nhan = data['ngay_nhan'];\r\n              o.is_roi_chua = this.taiKhoanTinhTrangXemRoiChua(o.ma_tai_khoan, i);\r\n              tinh_trang_xems.push(o);\r\n            });\r\n            tin_nhan.tinh_trang_xem = tinh_trang_xems;\r\n            tin_nhans.push(tin_nhan);\r\n          }\r\n        });\r\n        this.allBoxData[i].cuoc_tro_truyen.tin_nhan = tin_nhans;\r\n        // Điền tin nhắn cho boxData[i] thì lấy luôn nội dung của nó để đổ ra view cho đỡ lag\r\n        // Lấy vị trí bản thân\r\n        this.allBoxData[i].getViTriBanThan();\r\n        // Lấy vị trí tin nhắn cuối cùng\r\n        this.allBoxData[i].getIndexTinNhanCuoiCung();\r\n        // Lấy nội dung tin nhắn cuối cùng\r\n        this.allBoxData[i].getNoiDungCuoiCung();\r\n        // Tin nhắn cuối cùng được đọc chưa\r\n        this.allBoxData[i].getIsReaded();\r\n    \r\n        // Kiểm tra thử vị trí cuối cùng có phải là của bản thân hay không\r\n        this.allBoxData[i].isMe();\r\n        // Kiểm tra xem ông nào nhậ nchuwa\r\n        this.allBoxData[i].getIsDaNhan();\r\n        // Kiểm tra bản thân rời khỏi cuộc trò chuyện chưa\r\n        this.allBoxData[i].getIsRoiChua();\r\n\r\n        return;\r\n      }\r\n    }\r\n  }\r\n\r\n  public taiKhoanTinhTrangXemRoiChua(mtk: string, index: number): boolean {\r\n    for (let i = 0; i < this.allBoxData[index].thong_tin_thanh_vien.length; i++) {\r\n      if (this.allBoxData[index].thong_tin_thanh_vien[i].ma_tai_khoan == mtk) {\r\n        if (this.allBoxData[index].thong_tin_thanh_vien[i].roi_chua == 'roi') {\r\n          return true;\r\n        }\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  public sort(): void {\r\n    // sort lại theo ngày gửi của tin nhắn cuối cùng\r\n    this.allBoxData = this.allBoxData.sort((boxData1, boxData2) => {\r\n      let last_time_boxData1 = boxData1.getLastTime();\r\n      let last_time_boxData2 = boxData2.getLastTime();\r\n      return last_time_boxData2 - last_time_boxData1;\r\n    });\r\n  }\r\n\r\n  public dienTenVaHinhChoTaiKhoanTrongBoxData(key: string, value: object) {\r\n    if (this.allBoxData != null) {\r\n      for (let i = 0; i < this.allBoxData.length; i++) {\r\n        // Điền dữ liệu tài khoản cho thành viên\r\n        for (let j = 0; j < this.allBoxData[i].thong_tin_thanh_vien.length; j++) {\r\n          if (this.allBoxData[i].thong_tin_thanh_vien[j].ma_tai_khoan == key) {\r\n            this.allBoxData[i].thong_tin_thanh_vien[j].ten = value['ten'];\r\n            this.allBoxData[i].thong_tin_thanh_vien[j].link_hinh_dai_dien = value['link_hinh'];\r\n            this.allBoxData[i].thong_tin_thanh_vien[j].email = value['email'];\r\n            // khi thông tin thành viên có link hình thì cập nhật lại img avatar ở cuộc trò chuyện để đổ \r\n            // ra view ko bị lag\r\n            // img \r\n            this.allBoxData[i].getImgAvatar();\r\n            // Tên - tên nhóm - hoặc người nếu là đơn\r\n            this.allBoxData[i].getName();\r\n            break;\r\n          }\r\n        }\r\n        // Điền duẽ liệu tài khoản cho cuoc_tro_chuyen\r\n        if (this.allBoxData[i].cuoc_tro_truyen.ma_tai_khoan_chu_so_huu == key) {\r\n          this.allBoxData[i].cuoc_tro_truyen.ten_nguoi_so_huu = value['ten'];\r\n        }\r\n        // Điền dữ liệu tài khoản cho tin nhắn\r\n        if (this.allBoxData[i].cuoc_tro_truyen.tin_nhan != null) {\r\n          for (let j = 0; j < this.allBoxData[i].cuoc_tro_truyen.tin_nhan.length; j++) {\r\n            // Tình trạng xem\r\n            for (let k = 0; k < this.allBoxData[i].cuoc_tro_truyen.tin_nhan[j].tinh_trang_xem.length; k++) {\r\n              if (this.allBoxData[i].cuoc_tro_truyen.tin_nhan[j].tinh_trang_xem[k].ma_tai_khoan == key) {\r\n                this.allBoxData[i].cuoc_tro_truyen.tin_nhan[j].tinh_trang_xem[k].ten = value['ten'];\r\n                this.allBoxData[i].cuoc_tro_truyen.tin_nhan[j].tinh_trang_xem[k].hinh = value['link_hinh'];\r\n              }\r\n            }\r\n            // Tin nhắn\r\n            if (this.allBoxData[i].cuoc_tro_truyen.tin_nhan[j].ma_tai_khoan == key) {\r\n              this.allBoxData[i].cuoc_tro_truyen.tin_nhan[j].ten = value['ten'];\r\n            }\r\n          }\r\n          // Điền hết tình trạgn xem của tin nhắn thì get imgseened\r\n          this.allBoxData[i].getImgUserSeened();\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  public getBoxData(key: string, value: object): ChatPageFriendsObjectLeftWS {\r\n    let ma_tai_khoan = JSON.parse(localStorage.getItem(\"ma_tai_khoan_dn_ws\"));\r\n    let boxData = new ChatPageFriendsObjectLeftWS();\r\n    for (let i = 0; i < this.allCuocTroTruyen.length; i++) {\r\n      if (this.allCuocTroTruyen[i].ma_cuoc_tro_chuyen == key) {\r\n        // clone chat page cuoc tro chuyen\r\n        let chatPageCuocTroChuyen = new ChatPageCuocTroChuyenWS();\r\n        chatPageCuocTroChuyen.ma_cuoc_tro_chuyen = this.allCuocTroTruyen[i].ma_cuoc_tro_chuyen;\r\n        chatPageCuocTroChuyen.loai_cuoc_tro_truyen = this.allCuocTroTruyen[i].loai_cuoc_tro_truyen;\r\n        chatPageCuocTroChuyen.ngay_tao = this.allCuocTroTruyen[i].ngay_tao;\r\n        chatPageCuocTroChuyen.ten_nhom = this.allCuocTroTruyen[i].ten_nhom;\r\n        chatPageCuocTroChuyen.ton_tai = this.allCuocTroTruyen[i].ton_tai;\r\n        chatPageCuocTroChuyen.ma_tai_khoan_chu_so_huu = this.allCuocTroTruyen[i].ma_tai_khoan_chu_so_huu;\r\n        chatPageCuocTroChuyen.ten_nguoi_so_huu = this.allCuocTroTruyen[i].ten_nguoi_so_huu;\r\n        boxData.cuoc_tro_truyen = chatPageCuocTroChuyen;\r\n        // Điền các thông tin đầu tiên cho các thành viên\r\n        let thong_tin_thanh_vien: ChatPageObjectTinNhanFriendWS[] = [];\r\n        // oke khi có bản thân và bản thân phải ko chờ\r\n        let isOke = false;\r\n        Object.entries(value).forEach(([key2, value2]) => {\r\n          let chat_page_object_tin_nhan_friend = new ChatPageObjectTinNhanFriendWS();\r\n          chat_page_object_tin_nhan_friend.ma_tai_khoan = key2;\r\n          chat_page_object_tin_nhan_friend.ngay_tham_gia = value2['ngay_tham_gia'];\r\n          chat_page_object_tin_nhan_friend.ngay_roi_di = value2['ngay_roi_di'];\r\n          chat_page_object_tin_nhan_friend.roi_chua = value2['roi_chua'];\r\n          thong_tin_thanh_vien.push(chat_page_object_tin_nhan_friend);\r\n          if (!isOke) {\r\n            if (key2 == ma_tai_khoan) {\r\n              if (value2['trang_thai'] == 'khong_cho') {\r\n                isOke = true;\r\n              }\r\n            }\r\n          }\r\n        });\r\n        if (!isOke) return null;\r\n        boxData.thong_tin_thanh_vien = thong_tin_thanh_vien;\r\n        boxData.box_chat_dang_duoc_chon = false;\r\n        break;\r\n      }\r\n    }\r\n    return boxData;\r\n  }\r\n\r\n  public getAllTaiKhoan() {\r\n    return this.db.object(\"/tai_khoan_ws\").snapshotChanges();\r\n  }\r\n\r\n  public getAllChiTietCuocTroChuyen() {\r\n    return this.db.object(\"/chi_tiet_cuoc_tro_chuyen_ws\").snapshotChanges();\r\n  }\r\n\r\n  public getAllCuocTroChuyen() {\r\n    return this.db.object(\"/cuoc_tro_chuyen_ws\").snapshotChanges();\r\n  }\r\n\r\n  public getAllCuocTroChuyenNhom() {\r\n    return this.db.object(\"/thong_tin_tro_chuyen_nhom_ws\").snapshotChanges();\r\n  }\r\n\r\n  public dienThongTinNhom(ma_nhom: string, value: object) {\r\n    for (let i = 0; i < this.allCuocTroTruyen.length; i++) {\r\n      if (this.allCuocTroTruyen[i].loai_cuoc_tro_truyen == 'nhom') {\r\n        if (this.allCuocTroTruyen[i].ma_cuoc_tro_chuyen == ma_nhom && value['ton_tai'] == 0) {\r\n          this.allCuocTroTruyen[i].ten_nhom = value['ten_nhom'];\r\n          this.allCuocTroTruyen[i].ngay_tao = value['ngay_tao'];\r\n          this.allCuocTroTruyen[i].ma_tai_khoan_chu_so_huu = value['chu_so_huu'];\r\n          this.allCuocTroTruyen[i].ton_tai = value['ton_tai'];\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  public getThanhVienCuocTroTruyen() {\r\n    return this.db.object(\"/thanh_vien_cuoc_tro_chuyen_ws\").snapshotChanges();\r\n  }\r\n}"],"sourceRoot":""},"metadata":{},"sourceType":"module"}