{"ast":null,"code":"import _asyncToGenerator from \"E:/Important/FIT/project-front-end/FrontEnd_ThayLong_Nhom-21/app-chat/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { generateUniqueNumber } from 'fast-unique-numbers';\nimport { renderUnknownPortIdError } from './error-renderers';\nimport { isSupportingTransferables } from './is-supporting-transferables';\nconst DESTROY_WORKER_FUNCTIONS = new Map();\nexport const extendWorkerImplementation = (createWorker, partialWorkerImplementation, isSupportedFunction) => ({ ...partialWorkerImplementation,\n  connect: ({\n    port\n  }) => {\n    port.start();\n    const destroyWorker = createWorker(port, partialWorkerImplementation);\n    const portId = generateUniqueNumber(DESTROY_WORKER_FUNCTIONS);\n    DESTROY_WORKER_FUNCTIONS.set(portId, () => {\n      destroyWorker();\n      port.close();\n      DESTROY_WORKER_FUNCTIONS.delete(portId);\n    });\n    return {\n      result: portId\n    };\n  },\n  disconnect: ({\n    portId\n  }) => {\n    const destroyWorker = DESTROY_WORKER_FUNCTIONS.get(portId);\n\n    if (destroyWorker === undefined) {\n      throw renderUnknownPortIdError({\n        portId: portId.toString()\n      });\n    }\n\n    destroyWorker();\n    return {\n      result: null\n    };\n  },\n  isSupported: function () {\n    var _ref = _asyncToGenerator(function* () {\n      const isSelfSupported = yield isSupportingTransferables();\n\n      if (isSelfSupported) {\n        const result = isSupportedFunction();\n        const synchronousResult = result instanceof Promise ? yield result : result;\n        return {\n          result: synchronousResult\n        };\n      }\n\n      return {\n        result: false\n      };\n    });\n\n    return function isSupported() {\n      return _ref.apply(this, arguments);\n    };\n  }()\n}); //# sourceMappingURL=extend-worker-implementation.js.map","map":{"version":3,"sources":["E:/Important/FIT/project-front-end/FrontEnd_ThayLong_Nhom-21/app-chat/node_modules/worker-factory/build/es2019/helpers/extend-worker-implementation.js"],"names":["generateUniqueNumber","renderUnknownPortIdError","isSupportingTransferables","DESTROY_WORKER_FUNCTIONS","Map","extendWorkerImplementation","createWorker","partialWorkerImplementation","isSupportedFunction","connect","port","start","destroyWorker","portId","set","close","delete","result","disconnect","get","undefined","toString","isSupported","isSelfSupported","synchronousResult","Promise"],"mappings":";AAAA,SAASA,oBAAT,QAAqC,qBAArC;AACA,SAASC,wBAAT,QAAyC,mBAAzC;AACA,SAASC,yBAAT,QAA0C,+BAA1C;AACA,MAAMC,wBAAwB,GAAG,IAAIC,GAAJ,EAAjC;AACA,OAAO,MAAMC,0BAA0B,GAAG,CAACC,YAAD,EAAeC,2BAAf,EAA4CC,mBAA5C,MAAqE,EAC3G,GAAGD,2BADwG;AAE3GE,EAAAA,OAAO,EAAE,CAAC;AAAEC,IAAAA;AAAF,GAAD,KAAc;AACnBA,IAAAA,IAAI,CAACC,KAAL;AACA,UAAMC,aAAa,GAAGN,YAAY,CAACI,IAAD,EAAOH,2BAAP,CAAlC;AACA,UAAMM,MAAM,GAAGb,oBAAoB,CAACG,wBAAD,CAAnC;AACAA,IAAAA,wBAAwB,CAACW,GAAzB,CAA6BD,MAA7B,EAAqC,MAAM;AACvCD,MAAAA,aAAa;AACbF,MAAAA,IAAI,CAACK,KAAL;AACAZ,MAAAA,wBAAwB,CAACa,MAAzB,CAAgCH,MAAhC;AACH,KAJD;AAKA,WAAO;AAAEI,MAAAA,MAAM,EAAEJ;AAAV,KAAP;AACH,GAZ0G;AAa3GK,EAAAA,UAAU,EAAE,CAAC;AAAEL,IAAAA;AAAF,GAAD,KAAgB;AACxB,UAAMD,aAAa,GAAGT,wBAAwB,CAACgB,GAAzB,CAA6BN,MAA7B,CAAtB;;AACA,QAAID,aAAa,KAAKQ,SAAtB,EAAiC;AAC7B,YAAMnB,wBAAwB,CAAC;AAAEY,QAAAA,MAAM,EAAEA,MAAM,CAACQ,QAAP;AAAV,OAAD,CAA9B;AACH;;AACDT,IAAAA,aAAa;AACb,WAAO;AAAEK,MAAAA,MAAM,EAAE;AAAV,KAAP;AACH,GApB0G;AAqB3GK,EAAAA,WAAW;AAAA,iCAAE,aAAY;AACrB,YAAMC,eAAe,SAASrB,yBAAyB,EAAvD;;AACA,UAAIqB,eAAJ,EAAqB;AACjB,cAAMN,MAAM,GAAGT,mBAAmB,EAAlC;AACA,cAAMgB,iBAAiB,GAAGP,MAAM,YAAYQ,OAAlB,SAAkCR,MAAlC,GAA2CA,MAArE;AACA,eAAO;AAAEA,UAAAA,MAAM,EAAEO;AAAV,SAAP;AACH;;AACD,aAAO;AAAEP,QAAAA,MAAM,EAAE;AAAV,OAAP;AACH,KARU;;AAAA;AAAA;AAAA;AAAA;AArBgG,CAArE,CAAnC,C,CA+BP","sourcesContent":["import { generateUniqueNumber } from 'fast-unique-numbers';\r\nimport { renderUnknownPortIdError } from './error-renderers';\r\nimport { isSupportingTransferables } from './is-supporting-transferables';\r\nconst DESTROY_WORKER_FUNCTIONS = new Map();\r\nexport const extendWorkerImplementation = (createWorker, partialWorkerImplementation, isSupportedFunction) => ({\r\n    ...partialWorkerImplementation,\r\n    connect: ({ port }) => {\r\n        port.start();\r\n        const destroyWorker = createWorker(port, partialWorkerImplementation);\r\n        const portId = generateUniqueNumber(DESTROY_WORKER_FUNCTIONS);\r\n        DESTROY_WORKER_FUNCTIONS.set(portId, () => {\r\n            destroyWorker();\r\n            port.close();\r\n            DESTROY_WORKER_FUNCTIONS.delete(portId);\r\n        });\r\n        return { result: portId };\r\n    },\r\n    disconnect: ({ portId }) => {\r\n        const destroyWorker = DESTROY_WORKER_FUNCTIONS.get(portId);\r\n        if (destroyWorker === undefined) {\r\n            throw renderUnknownPortIdError({ portId: portId.toString() });\r\n        }\r\n        destroyWorker();\r\n        return { result: null };\r\n    },\r\n    isSupported: async () => {\r\n        const isSelfSupported = await isSupportingTransferables();\r\n        if (isSelfSupported) {\r\n            const result = isSupportedFunction();\r\n            const synchronousResult = result instanceof Promise ? await result : result;\r\n            return { result: synchronousResult };\r\n        }\r\n        return { result: false };\r\n    }\r\n});\r\n//# sourceMappingURL=extend-worker-implementation.js.map"]},"metadata":{},"sourceType":"module"}